<!DOCTYPE html>
<html>
  <head>
    <title>Task Menu</title>
    <script>
      var aors = true;
      function request(str) {
         var xhttp = new XMLHttpRequest();
         xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
               document.getElementById("tasks").innerHTML = this.responseText;
            }
         };
         xhttp.open("GET", "/data/:"+str, true);
         xhttp.send();
      }
      function edit(id) {
         var xhttp = new XMLHttpRequest();
         xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
               document.getElementById(id).innerHTML = this.responseText;
            }
         };
         xhttp.open("GET", "/add", true);
         xhttp.send();
      }
      function add() {
         if (aors == true) {
         aors = false;
         var xhttp = new XMLHttpRequest();
         xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
               document.getElementById("add").innerHTML = this.responseText;
            }
         };
         xhttp.open("GET", "/add", true);
         xhttp.send();
         }
         else {
            aors = true;
            document.getElementById("add").innerHTML = "";
         }
      }
    </script>
  </head>
  <body>
    <h1>Welcome <%= userValue.name %></h1>
    <h2>Current Tasks</h2>
    <div id="tasks">
      <% for (var i = 0; i < userValue.size; i++) { %>
	 <input type="checkbox" onclick="request(<%=userValue.object[i].studentid%>)"> <button onclick="edit(<%= userValue.object[i].studentid %>)">Edit</button><%= userValue.task[i] %> <br>
	 <div id=<%= userValue.object[i].studentid %>></div>
	 <% } %>
    </div><br>
    <button onclick=add()>Add A Task</button>
    <div id="add"></div>
  </body>
</html>
